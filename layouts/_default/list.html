{{ define "main" }}
<div class="container mx-auto px-4 py-12">
    <!-- Breadcrumbs -->
    {{ partial "breadcrumbs.html" . }}

    <!-- Header -->
    <header class="mb-12 max-w-4xl">
        <h1 class="font-heading text-3xl md:text-5xl font-bold text-slate-800 mb-4">{{ .Title }}</h1>
        <div class="prose prose-lg text-slate-600">
            {{ .Content }}
        </div>
    </header>

    <div class="flex flex-col lg:flex-row gap-12">
        <!-- Sidebar Filter (Desktop) -->
        <aside class="w-full lg:w-64 flex-shrink-0">
            <div class="sticky top-24">
                <h3 class="font-bold text-slate-900 mb-4 uppercase text-sm tracking-wider">Filter By Style</h3>
                <div class="space-y-2">
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" class="form-checkbox text-teal-600 rounded">
                        <span>Bold & Simple</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer">
                        <input type="checkbox" class="form-checkbox text-teal-600 rounded">
                        <span>Realistic</span>
                    </label>
                </div>
            </div>
        </aside>

        <!-- The Masonry Grid -->
        <div class="flex-grow">
            {{ if eq (len .Pages) 0 }}
            <div class="p-12 text-center bg-stone-100 rounded-lg">
                <p class="text-slate-500">No pages found in this collection yet.</p>
            </div>
            {{ else }}
            <div class="masonry-grid">
                {{ range .Pages }}
                <div class="masonry-item">
                    <a href="{{ .RelPermalink }}"
                        class="block group bg-white rounded-xl shadow-sm hover:shadow-lg transition overflow-hidden">
                        <div class="relative bg-white aspect-[3/4]">
                            <!-- Use Imgix/R2 placeholder logic if real image exists -->
                            {{ if .Params.image_url }}
                            <img src="{{ .Params.image_url }}" alt="{{ .Title }}" class="w-full h-full object-contain">
                            {{ else }}
                            <div class="w-full h-full bg-slate-50 flex items-center justify-center text-slate-300">No
                                Image</div>
                            {{ end }}

                            <div class="absolute inset-0 bg-black/0 group-hover:bg-black/5 transition"></div>
                        </div>
                        <div class="p-4 border-t border-slate-50">
                            <h3 class="font-bold text-slate-700 text-sm leading-tight group-hover:text-teal-600">{{
                                .Title }}</h3>
                            {{ if .Params.difficulty }}
                            <span
                                class="inline-block mt-2 text-xs font-semibold text-slate-400 bg-slate-100 px-2 py-0.5 rounded">{{
                                .Params.difficulty }}</span>
                            {{ end }}
                        </div>
                    </a>
                </div>
                {{ end }}
            </div>
            {{ end }}
        </div>
    </div>
</div>
{{ end }}